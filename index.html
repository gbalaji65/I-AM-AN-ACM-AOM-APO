<body id="main-body">
  ver 18
  <div id="div-1">
    <!-- Embedded Google Sheet iframe -->
    <iframe id="gsheet-frame" width="100%" height="80%"></iframe>
    <div class="overlay"></div>
  </div>

  <script>
    // Define the base URL for the Google Sheets embed
    const baseUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRBOtpi8G-lRWH-xsBNKdEsZSjV31hhhC8Bw79tqxrj3eKwtH5jj-OCNJyYcleCQk8zDxYWBqmXswdA/pubhtml?widget=true&headers=true&chrome=false";

    // Function to get query parameters from the URL
    function getQueryParam(name) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(name);
    }

    // Function to update the iframe source with the gid from the URL, defaulting to 0 if not found
    function updateIframeSource() {
      let gid = getQueryParam('gid'); // Get the 'gid' from the query string
      if (!gid) {
        gid = '0'; // Default to 0 if gid is not found
      }

      // Update iframe src with the base URL and the gid parameter
      const iframe = document.getElementById('gsheet-frame');
      iframe.src = baseUrl + "&gid=" + gid; // Append the gid parameter (or default 0) to the iframe src URL
    }

    // Call the function to update iframe source when the page loads
    window.onload = updateIframeSource();

    // Add event listener to detect mouse hover inside the iframe and log the link
    const iframe = document.getElementById('gsheet-frame');

    iframe.onload = function() {
      const iframeWindow = iframe.contentWindow;

      // Event listener to capture hover on links inside the iframe
      iframeWindow.document.addEventListener("mouseenter", function(event) {
        const hoveredLink = event.target.closest("a");

        if (hoveredLink) {
          console.log("Hovered link URL:", hoveredLink.href); // Log link URL when hovering
          event.preventDefault(); // Prevent the link from being followed (opened in a new tab)
        }
      }, true); // Using 'true' to ensure it works during the capturing phase
    };
  </script>
</body>
